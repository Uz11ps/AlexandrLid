# План реализации требований заказчика

## Приоритет 1: Формы создания в веб-интерфейсе

### 1.1 Рассылки
- ✅ API уже есть (`POST /api/bot-admin/broadcasts`)
- ⏳ Добавить форму создания в `BotAdmin.jsx`
- ⏳ Добавить форму редактирования
- ⏳ Добавить кнопку отправки рассылки

### 1.2 Розыгрыши
- ✅ API уже есть (`POST /api/bot-admin/giveaways`)
- ⏳ Добавить форму создания в `BotAdmin.jsx`
- ⏳ Добавить форму редактирования

### 1.3 Автоворонки
- ✅ API уже есть (`POST /api/bot-admin/autofunnels`)
- ⏳ Добавить форму создания в `BotAdmin.jsx`
- ⏳ Добавить форму редактирования

### 1.4 Лид-магниты
- ✅ API уже есть (`POST /api/bot-admin/lead-magnets`)
- ⏳ Добавить форму создания в `BotAdmin.jsx`
- ⏳ Добавить форму редактирования

## Приоритет 2: Система чата/тикетов

### 2.1 База данных
- ⏳ Создать таблицу `tickets`
- ⏳ Создать таблицу `ticket_messages`
- ⏳ Связь с пользователями и менеджерами

### 2.2 Backend API
- ⏳ `GET /api/tickets` - список тикетов
- ⏳ `GET /api/tickets/:id` - детали тикета
- ⏳ `POST /api/tickets` - создать тикет
- ⏳ `POST /api/tickets/:id/messages` - отправить сообщение
- ⏳ `GET /api/tickets/:id/messages` - получить сообщения
- ⏳ Интеграция с Telegram ботом для отправки сообщений

### 2.3 Frontend
- ⏳ Страница "Чат" со списком тикетов
- ⏳ Страница деталей тикета с перепиской
- ⏳ Возможность создать тикет из карточки лида
- ⏳ Возможность начать диалог с пользователем

### 2.4 Telegram Bot
- ⏳ Команда `/ticket` для создания тикета пользователем
- ⏳ Обработка сообщений в тикетах
- ⏳ Отправка сообщений от менеджера пользователю

## Приоритет 3: Система прав доступа

### 3.1 База данных
- ⏳ Создать таблицу `permissions` (список всех прав)
- ⏳ Создать таблицу `role_permissions` (права по ролям)
- ⏳ Создать таблицу `user_permissions` (права по пользователям)
- ⏳ Обновить таблицу `managers` для поддержки ролей

### 3.2 Backend API
- ⏳ `GET /api/permissions` - список всех прав
- ⏳ `GET /api/permissions/roles/:role` - права роли
- ⏳ `PUT /api/permissions/roles/:role` - обновить права роли
- ⏳ `GET /api/permissions/users/:userId` - права пользователя
- ⏳ `PUT /api/permissions/users/:userId` - обновить права пользователя
- ⏳ Middleware для проверки прав

### 3.3 Frontend
- ⏳ Страница "Управление правами"
- ⏳ Вкладка "Права по ролям"
- ⏳ Вкладка "Права по пользователям"
- ⏳ Чекбоксы для каждого права в каждом разделе

## Порядок реализации

1. **Этап 1**: Формы создания в вебке (быстро, улучшит UX)
2. **Этап 2**: Система чата/тикетов (основной функционал)
3. **Этап 3**: Система прав доступа (безопасность и контроль)

