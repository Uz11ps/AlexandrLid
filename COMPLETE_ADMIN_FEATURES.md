# Полный функционал админки в веб-интерфейсе

## ✅ Реализовано

### 1. Управление пользователями CRM
- ✅ Страница "Пользователи CRM" (`/users-management`)
- ✅ Создание новых пользователей (менеджеров)
- ✅ Редактирование пользователей
- ✅ Назначение ролей
- ✅ Управление правами доступа
- ✅ Удаление пользователей (кроме админов)
- ✅ Активация/деактивация пользователей

### 2. Управление ролями
- ✅ Просмотр всех ролей
- ✅ Управление правами для ролей (через страницу "Права доступа")

### 3. Полный функционал админки бота в веб-интерфейсе

#### Статистика
- ✅ Просмотр статистики (всего пользователей, рефералов, рассылок)

#### Пользователи бота
- ✅ Просмотр списка пользователей
- ✅ Блокировка/разблокировка пользователей
- ✅ Просмотр деталей пользователя

#### Рассылки
- ✅ Создание рассылок
- ✅ Просмотр списка рассылок
- ✅ Отправка рассылок
- ✅ Редактирование рассылок (endpoint готов)
- ✅ Удаление рассылок (endpoint готов)
- ⏳ Диалог редактирования (нужно добавить в UI)

#### Автоворонки
- ✅ Создание автоворонок
- ✅ Просмотр списка автоворонок
- ✅ Включение/выключение автоворонок
- ✅ Редактирование автоворонок (endpoint готов)
- ✅ Удаление автоворонок (endpoint готов)
- ⏳ Диалог редактирования (нужно добавить в UI)

#### Лид-магниты
- ✅ Создание лид-магнитов
- ✅ Просмотр списка лид-магнитов
- ✅ Активация лид-магнитов
- ✅ Редактирование лид-магнитов (endpoint готов)
- ✅ Удаление лид-магнитов (endpoint готов)
- ⏳ Диалог редактирования (нужно добавить в UI)

#### Розыгрыши
- ✅ Создание розыгрышей
- ✅ Просмотр списка розыгрышей
- ✅ Редактирование розыгрышей (endpoint готов)
- ✅ Удаление розыгрышей (endpoint готов)
- ⏳ Диалог редактирования (нужно добавить в UI)
- ⏳ Определение победителей (нужно добавить)

#### Экспорт данных
- ✅ Экспорт всех пользователей (CSV/Excel)
- ✅ Экспорт активных пользователей (CSV/Excel)
- ✅ Экспорт топ рефералов (CSV/Excel)

#### Настройки
- ✅ Просмотр настроек канала
- ✅ Редактирование настроек канала (ID и username)

## ⏳ Что нужно доработать

### Диалоги редактирования
Нужно добавить диалоги редактирования для:
1. Рассылок (`editBroadcast`)
2. Автоворонок (`editAutofunnel`)
3. Розыгрышей (`editGiveaway`)
4. Лид-магнитов (`editLeadMagnet`)

### Дополнительный функционал
1. Определение победителей розыгрышей
2. Просмотр деталей пользователя бота (с рефералами)
3. История рассылок

## API Endpoints

### Пользователи CRM
- `GET /api/managers` - список менеджеров
- `GET /api/managers/:id` - детали менеджера
- `PUT /api/managers/:id` - обновить менеджера
- `DELETE /api/managers/:id` - удалить менеджера
- `POST /api/auth/register` - создать менеджера (только админ)

### Админка бота
- `GET /api/bot-admin/stats` - статистика
- `GET /api/bot-admin/users` - список пользователей бота
- `GET /api/bot-admin/users/:userId` - детали пользователя
- `POST /api/bot-admin/users/:userId/ban` - заблокировать
- `POST /api/bot-admin/users/:userId/unban` - разблокировать
- `GET /api/bot-admin/broadcasts` - список рассылок
- `POST /api/bot-admin/broadcasts` - создать рассылку
- `PUT /api/bot-admin/broadcasts/:id` - редактировать рассылку
- `POST /api/bot-admin/broadcasts/:id/send` - отправить рассылку
- `DELETE /api/bot-admin/broadcasts/:id` - удалить рассылку
- `GET /api/bot-admin/autofunnels` - список автоворонок
- `POST /api/bot-admin/autofunnels` - создать автоворонку
- `PUT /api/bot-admin/autofunnels/:id` - редактировать автоворонку
- `DELETE /api/bot-admin/autofunnels/:id` - удалить автоворонку
- `GET /api/bot-admin/lead-magnets` - список лид-магнитов
- `POST /api/bot-admin/lead-magnets` - создать лид-магнит
- `PUT /api/bot-admin/lead-magnets/:id` - редактировать лид-магнит
- `POST /api/bot-admin/lead-magnets/:id/activate` - активировать лид-магнит
- `DELETE /api/bot-admin/lead-magnets/:id` - удалить лид-магнит
- `GET /api/bot-admin/giveaways` - список розыгрышей
- `POST /api/bot-admin/giveaways` - создать розыгрыш
- `PUT /api/bot-admin/giveaways/:id` - редактировать розыгрыш
- `DELETE /api/bot-admin/giveaways/:id` - удалить розыгрыш
- `GET /api/bot-admin/export/:type/:format` - экспорт данных
- `GET /api/bot-admin/settings` - получить настройки
- `PUT /api/bot-admin/settings/channel` - обновить настройки канала

## Применение изменений

```bash
cd /opt/AlexandrLid
git pull
docker compose build --no-cache
docker compose restart
```

## Доступ к функциям

1. **Управление пользователями CRM**: `/users-management`
2. **Админка бота**: `/bot-admin`
3. **Права доступа**: `/permissions`

Все функции доступны только администраторам (роль `admin`).

